# 범죄 데이터 기반 범죄 예측 및 순찰 알고리즘
#### Crime Data-Based Crime Prediction and Patrol Algorithm
범죄와의 전쟁(류형주, 김동연, 김영서)
### http://crime2.dothome.co.kr/

### 개요
해당 프로젝트는 중구의 날씨, 유동인구, 경찰서 위치, CCTV 개수 등다양한 데이터를 활용하여 각 지점별 범죄를 예측합니다.범죄의 예측 결과를 바탕으로 순찰 경로를 구성하고,실시간 교통정보를 반영하여 최적의 경로를 화면에 출력합니다.예상 초동조치 시간, 경로 순회시간를 확인할 수도 있습니다.


### 목적
경찰관의 경험에 의존한 기존의 순찰경로를 데이터 분석을 이용해 개선해보고자 프로젝트를 기획하게 되었습니다. 머신러닝을 이용하여 지역별 범죄를 예측하고, 그 결과를 바탕으로 기존과 비교해 범죄의 초동조치 시간이 개선된 순찰경로를 구성하는 것을 목표로 합니다. 데이터를 이용해, 인간의 경험이나 감의 영역을 뛰어넘어, 더 효율적인 순찰경로를 구성한다면 범죄의 예방이나 빠른 초동조치에도 큰 도움이 될 것입니다.

### 구현
![image](https://user-images.githubusercontent.com/26182769/122636196-dbb38280-d122-11eb-893a-91da9f08a3de.png)
![image](https://user-images.githubusercontent.com/26182769/122636071-33052300-d122-11eb-99a4-f6be138f2b46.png)
![image](https://user-images.githubusercontent.com/26182769/122636094-516b1e80-d122-11eb-9d85-e99cb2c8e5e6.png)
#### 범죄예측
먼저 범죄 예측 단계에서는 먼저 범죄와 연관 될 수 있는 다양한 정보들을 수집했습니다. 기상청에서 제공하는 2014년~2019년 날씨 데이터, CCTV, 경찰서의 위치 데이터, 유동인구 및 거주인구 데이터를 전처리하여 데이터베이스에 입력했습니다. 해당 데이터들을 범죄 예측의 변수로 선정한 것은, 다양한 논문들을 근거로 했습니다. 범죄 데이터는 완전한 실제 데이터 수집에는 어려움이 있었고, 2014년도 부터 2019년도 까지의 범죄 통계를 기반으로 하여 데이터를 생성했습니다. 일정 비율은 랜덤으로, 일정 비율은 CCTV와 경찰서가 없고, 인구가 많은 지역을 선별해 경향성 데이터를 추가했습니다. 저희는 이 모든 데이터를, 중구지도를 100m 간격으로 쪼갠 그리드 단위로 올려 데이터베이스에 추가했고, 데이터베이스에서는 모델 학습에 필요한 형식으로 반환할 수 있도록 연산을 실행했습니다.

구성한 데이터베이스를 바탕으로 저희가 설계한 모델입니다. 현재의 계절, 날씨, 시간을 입력하면 해당하는 데이터셋을 DB에서 가져오고, 하나의 그리드 안에 있는 범죄 수, CCTV, 유동인구, 경찰서, 거주인구가 하나의 학습 데이터가 됩니다. 모델은 학습 데이터를 바탕으로 범죄 건수를 예측하고, 실제 범죄 데이터로 피드백을 하며 모델을 학습하는 지도학습의 형식으로 결정했습니다. 그래서 저희는 의사결정나무, SVM, 랜덤포레스트, 딥러닝 모델을 후보로 고려했습니다. 그 중에서 데이터, 매개변수에 민감한 방법(SVM, 딥러닝)을 제외하고, 내부의 어떤 일이 일어나는지 알기 어려운 블랙박스 알고리즘(랜덤포레스트, 딥러닝)을 제외했습니다. 또 해당 문제에서 좋은 성능을 낸다는 논문도 있어, 의사결정 나무를 모델로 선택했습니다.

저희가 선택한 의사결정 나무가 과적합이 쉽게 일어난다는 단점을 데이터셋을 다양화 할 수 있는 K-Fold 교차검증, 라이브러리를 이용한 최적의 하이퍼 파라미터 설정 등 다양한 방법들로 성능을 높였습니다. 그렇게 예측한 결과는 혼동행렬을 범위 단위로 응용해 평가했고, 저희가 설정한 기준 값 이하일 시 모델을 재분석하는 과정을 진행했습니다.

![image](https://user-images.githubusercontent.com/26182769/122636108-66e04880-d122-11eb-8552-d464ae88ff16.png)
![image](https://user-images.githubusercontent.com/26182769/122636233-06054000-d123-11eb-8bff-9e0cb8e1926f.png)
![image](https://user-images.githubusercontent.com/26182769/122636245-1ae1d380-d123-11eb-8566-fb14930ca60c.png)
#### 순찰경로
범죄예측의 다음단계인 순찰 경로 알고리즘에 대해 설명드리겠습니다. 저희는 총 3가지 알고리즘(A, B, C)에 대해 성능 평가를 진행했습니다. 먼저 A는 전체 지역을 순회하는 것에만 집중한 알고리즘이고, 다음 B는 예측 결과 범죄 고위험 지역만을 순회하는 알고리즘입니다. 마지막 C는 구역을 나누고, 구역 내 범죄 위험도가 가장 높은 그리드를 순회하는 알고리즘입니다. 각 알고리즘들은 각각의 방법으로 경유지점을 추출했고, 경유지점의 순서를 정하는 문제는 TSP문제와 동일했기 때문에 문제해결을 최적화로 진행했습니다. A는 범죄 예측 결과가 하나도 포함되지 않은 대조군이며, B는 경로가 일부지역에 편중될 때 비효율적일 수 있음을 보여주는 대조군입니다. 저희가 제안하는 최적의 경로는 C알고리즘 입니다. 

알고리즘으로 구성한 경로는 다음과 같은 방법으로 평가했습니다. 먼저 부분 경로간 걸리는 시간을 구해서, 범죄 발생 시 순찰차가 특정 경로에 있을 확률을 계산했습니다. 그리고 해당 경로에서 몇개의 지점들을 추출해 해당 부분경로에 있을 시 범죄 발생 지점까지 평균적으로 시간이 얼마나 걸리는지 계산했습니다. 이를 경로당 900번 테스트하여, 평가의 정확성을 높였습니다. 그 최종결과로는 누적 초동조치 시간, 범죄 당 초동조치 시간 모두 C 알고리즘이 가장 좋은 성능을 보여줬습니다


